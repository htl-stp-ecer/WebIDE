<div class="mt-5 ml-20 mr-20">
  <p-button [label]="'PROJECT_MENU.BACK_TO_START' | translate" icon="pi pi-arrow-left" size="small" (onClick)="backToProjects()"></p-button>

  <div class="text-xl flex items-center gap-2 mt-30">
    {{ 'PROJECT_MENU.NAME_LABEL' | translate }}
    @if (!editingName) {
      <div class="flex items-center gap-1 cursor-pointer hover:text-gray-600" (click)="enableEdit()">
        <span>{{ connectionInfo?.hostname }}</span>
        <i class="pi pi-pencil text-gray-400 ml-2"></i>
      </div>
    } @else {
      <div class="flex items-center gap-2">
        <input [(ngModel)]="tempName"
               pInputText
               class="w-60"/>

        <p-button
          [label]="'COMMON.CANCEL' | translate"
          size="small"
          severity="secondary"
          (onClick)="disableEdit()"
        />

        <p-button
          [label]="'COMMON.SAVE' | translate"
          size="small"
          severity="success"
          (onClick)="finishEdit()"
        />

      </div>
    }


  </div>

  <div class="text-xl flex flex-col gap-4 mt-10">
    <div class="flex items-center gap-2">
      {{ 'PROJECT_MENU.DIMENSIONS_HEADING' | translate }}
      @if (!editingDimensions) {
        <div class="flex items-center gap-1 cursor-pointer hover:text-gray-600" (click)="enableDimensionsEdit()">
          <span>
            {{ formatDimension(connectionInfo?.width_cm) }} Ã— {{ formatDimension(connectionInfo?.length_cm) }} cm
          </span>
          <i class="pi pi-pencil text-gray-400 ml-2"></i>
        </div>
      }
    </div>

    @if (editingDimensions) {
      <div class="flex flex-col md:flex-row gap-4 md:items-end">
        <div class="flex flex-col">
          <label class="text-xs font-semibold text-gray-500 tracking-wide uppercase">
            {{ 'PROJECT_MENU.WIDTH_LABEL' | translate }}
          </label>
          <input type="number"
                 min="0"
                 step="0.1"
                 [(ngModel)]="tempWidth"
                 [ngModelOptions]="{standalone: true}"
                 pInputText
                 class="w-40"/>
        </div>

        <div class="flex flex-col">
          <label class="text-xs font-semibold text-gray-500 tracking-wide uppercase">
            {{ 'PROJECT_MENU.LENGTH_LABEL' | translate }}
          </label>
          <input type="number"
                 min="0"
                 step="0.1"
                 [(ngModel)]="tempLength"
                 [ngModelOptions]="{standalone: true}"
                 pInputText
                 class="w-40"/>
        </div>

        <div class="flex gap-2">
          <p-button
            [label]="'COMMON.CANCEL' | translate"
            size="small"
            severity="secondary"
            (onClick)="cancelDimensionsEdit()"
          />

          <p-button
            [label]="'COMMON.SAVE' | translate"
            size="small"
            severity="success"
            [disabled]="!canSaveDimensions"
            (onClick)="saveDimensions()"
          />
        </div>
      </div>
    }
  </div>

  <p-confirmDialog></p-confirmDialog>

  <div class="mt-20 text-xl">
    {{ 'PROJECT_MENU.PROJECTS_HEADING' | translate }}

    <div class="mt-10 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

      <p-card class="shadow-lg rounded-2xl border border-dashed border-gray-300 hover:border-gray-500 hover:shadow transition-all flex items-center justify-center" (click)="enableAddProject()" [ngClass]="!addingProject ? 'cursor-pointer' : ''">
        @if (!addingProject) {
          <button
            class="flex flex-col items-center justify-center w-full py-4 text-gray-500 hover:text-gray-700 cursor-pointer">
            <i class="pi pi-plus text-3xl mb-2"></i>
            <span class="text-lg font-medium">{{ 'PROJECT_MENU.ADD_PROJECT' | translate }}</span>
          </button>
        } @else {
          <div class="flex flex-col space-y-4 w-full">
            <input [(ngModel)]="newProjectName"
                   pInputText
                   [placeholder]="'PROJECT_MENU.PROJECT_NAME_PLACEHOLDER' | translate"
                   class="w-full"/>

            <div class="flex justify-end gap-2">
              <p-button
                [label]="'COMMON.CANCEL' | translate"
                size="small"
                severity="secondary"
                (onClick)="cancelAddProject(); $event.stopPropagation()" />

              <p-button
                [label]="'COMMON.SAVE' | translate"
                size="small"
                severity="success"
                (onClick)="createProject(); $event.stopPropagation()" />
            </div>
          </div>
        }
      </p-card>

      @for (project of projects; track project.uuid) {
        <p-card class="shadow-lg rounded-2xl border border-gray-200
           hover:shadow-xl hover:scale-105 hover:-translate-y-1 hover:bg-gray-50
           transition-all duration-300 min-h-[8rem] cursor-pointer" (click)="redirectToProject(project.uuid)">
          <div class="flex items-center justify-between h-full py-4">
            <div class="flex flex-col justify-center">
              <div class="text-lg font-semibold">{{ project.name }}</div>
              <p class="text-sm text-gray-500">{{ project.uuid }}</p>
            </div>
            <div class="flex items-center space-x-3">
              <button
                (click)="confirmDelete(project.uuid); $event.stopPropagation()"
                class="text-red-500 hover:text-red-700 cursor-pointer"
                [attr.aria-label]="'COMMON.DELETE' | translate">
                <i class="pi pi-trash text-lg"></i>
              </button>
            </div>
          </div>
        </p-card>
      }
    </div>
  </div>
</div>
