<div class="h-full flex flex-col">
  <!-- Timeline Section -->
  <div class="flex-1 overflow-hidden">
    <p-timeline
      cdkDropList
      [cdkDropListData]="missionTimelineData"
      (cdkDropListDropped)="drop($event)"
      [value]="missionTimelineData"
      layout="vertical"
      class="max-h-full overflow-y-auto p-4"
    >
      <ng-template let-item let-i="index" pTemplate="content">
        <div
          cdkDrag
          class="flex items-center gap-3 cursor-pointer"
          (click)="getDetailedMission(item.name)">
          <span class="text-gray-500">{{ item.order }}</span>
          <span>{{ item.name }}</span>
          <i class="pi pi-bars text-gray-400 ml-auto"></i>
        </div>
      </ng-template>
    </p-timeline>
  </div>
  <!-- Add Mission Section (Outside Timeline) -->
  <div class="p-4 border-t border-gray-200 mb-10">
    @if (!addingMission) {
      <p-card
        class="shadow-md rounded-2xl border border-dashed border-gray-300 hover:border-gray-500 hover:shadow transition-all cursor-pointer"
        (click)="enableAddMission()">
        <button class="flex flex-col items-center justify-center w-full py-4 text-gray-500 hover:text-gray-700">
          <i class="pi pi-plus text-3xl mb-2"></i>
          <span class="text-lg font-medium">Add Mission</span>
        </button>
      </p-card>
    } @else {
      <p-card class="shadow-md rounded-2xl">
        <div class="flex flex-col space-y-4 w-full">
          <input [(ngModel)]="newMissionName"
                 pInputText
                 placeholder="Mission name"
                 class="w-full"/>
          <div class="flex justify-end gap-2">
            <p-button
              label="Cancel"
              size="small"
              severity="secondary"
              (onClick)="cancelAddMission()"/>
            <p-button
              label="Save"
              size="small"
              severity="success"
              (onClick)="createMission()"/>
          </div>
        </div>
      </p-card>
    }
  </div>
</div>
